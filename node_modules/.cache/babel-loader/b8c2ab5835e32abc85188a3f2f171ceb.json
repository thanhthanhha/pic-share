{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git\\\\pic\\\\pic-share\\\\src\\\\helpers\\\\useAuth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState();\n  const [error, setError] = useState();\n  const [loading, setLoading] = useState(false);\n  const [isLogin, setisLogin] = useState(false);\n  const location = useLocation();\n  const history = useNavigate();\n  useEffect(() => {\n    if (error) setError(null);\n  }, [location.pathname]);\n  useEffect(() => {// async function verifyLogin() {\n    //     let token = localStorage.getItem('token');\n    //     let res = await axios.get(`${process.env.REACT_APP_BACKEND_URI}/welcome`,{\n    //         headers: {\n    //             'x-access-token' : token,\n    //             'Accept' : 'application/json',\n    //             'Content-Type' : '*/*',\n    //             'User-Agent' : 'Client',\n    //             'Connection' : 'keep-alive',\n    //             'Host' : 'localhost'\n    //         }\n    //     })\n    //     .then(res => {\n    //         if (res.username && res.token) {\n    //             setUser({...res}); \n    //         }\n    //         localStorage.setItem('token', user.token);\n    //         setisLogin(true);\n    //     })\n    //     .catch((error) => {\n    //         setError(error);\n    //         localStorage.removeItem('token');\n    //         setUser(null);\n    //         setisLogin(false);\n    //     })\n    // }\n    // verifyLogin();\n  });\n\n  const signUp = async (email, username, password) => {\n    setLoading(true);\n    console.log(process.env.REACT_APP_BACKEND_URI);\n    let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/register`, {\n      \"username\": username,\n      \"email\": email,\n      \"password\": password\n    }, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': '*/*',\n        'User-Agent': 'Client',\n        'Connection': 'keep-alive',\n        'Host': 'localhost'\n      }\n    }).then(res => {\n      if (res.username && res.token) {\n        setUser({ ...res\n        });\n      }\n\n      localStorage.setItem('token', user.token);\n      setisLogin(true);\n    }).catch(error => {\n      setError(error);\n      setUser(null);\n      setisLogin(false);\n    }).finally(() => setLoading(false));\n  };\n\n  const login = async (username, password) => {\n    setLoading(true);\n    let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/login`, {\n      \"username\": username,\n      \"password\": password\n    }, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(res => {\n      if (res.username && res.token) {\n        setUser(res);\n      }\n\n      console.log(user);\n      console.log(\"help\");\n      console.log(res);\n      localStorage.setItem('token', res.token);\n      setisLogin(true);\n      history(\"/browse\");\n    }).catch(error => {\n      let txterr = !error.message ? JSON.stringify(error) : error.message;\n      setError(txterr);\n      setUser(null);\n      setisLogin(false);\n    }).finally(() => setLoading(false));\n  };\n\n  const memoedVal = useMemo(() => ({\n    user,\n    error,\n    loading,\n    isLogin,\n    login,\n    signUp\n  }), [user, loading, error]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: memoedVal,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AuthProvider, \"lRAuxNZEyruk5ECikqWQdycBPow=\", false, function () {\n  return [useLocation, useNavigate];\n});\n\n_c = AuthProvider;\nexport default function useAuth() {\n  _s2();\n\n  return useContext(AuthContext);\n}\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","useLocation","useNavigate","axios","AuthContext","AuthProvider","children","user","setUser","error","setError","loading","setLoading","isLogin","setisLogin","location","history","pathname","signUp","email","username","password","console","log","process","env","REACT_APP_BACKEND_URI","res","post","headers","then","token","localStorage","setItem","catch","finally","login","txterr","message","JSON","stringify","memoedVal","useAuth"],"sources":["D:/Git/pic/pic-share/src/helpers/useAuth.js"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport axios from 'axios';\r\n\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n    const [user, setUser] = useState();\r\n    const [error, setError] = useState();\r\n    const [loading, setLoading] = useState(false);\r\n    const [isLogin, setisLogin] = useState(false);\r\n\r\n    const location = useLocation();\r\n    const history = useNavigate();\r\n\r\n    useEffect(() => {\r\n        if (error) setError(null);\r\n      }, [location.pathname]);\r\n\r\n    useEffect(() => {\r\n        // async function verifyLogin() {\r\n        //     let token = localStorage.getItem('token');\r\n        //     let res = await axios.get(`${process.env.REACT_APP_BACKEND_URI}/welcome`,{\r\n        //         headers: {\r\n        //             'x-access-token' : token,\r\n        //             'Accept' : 'application/json',\r\n        //             'Content-Type' : '*/*',\r\n        //             'User-Agent' : 'Client',\r\n        //             'Connection' : 'keep-alive',\r\n        //             'Host' : 'localhost'\r\n        //         }\r\n        //     })\r\n        //     .then(res => {\r\n        //         if (res.username && res.token) {\r\n        //             setUser({...res}); \r\n        //         }\r\n        //         localStorage.setItem('token', user.token);\r\n        //         setisLogin(true);\r\n        //     })\r\n        //     .catch((error) => {\r\n        //         setError(error);\r\n        //         localStorage.removeItem('token');\r\n        //         setUser(null);\r\n        //         setisLogin(false);\r\n        //     })\r\n        // }\r\n\r\n        // verifyLogin();\r\n    })\r\n\r\n    const signUp = async (email, username, password) => {\r\n        setLoading(true);\r\n        console.log(process.env.REACT_APP_BACKEND_URI);\r\n\r\n        let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/register`, {\r\n                \"username\": username,\r\n                \"email\" : email,\r\n                \"password\": password\r\n        },{\r\n            headers: {\r\n                'Accept' : 'application/json',\r\n                'Content-Type' : '*/*',\r\n                'User-Agent' : 'Client',\r\n                'Connection' : 'keep-alive',\r\n                'Host' : 'localhost'\r\n            }\r\n        })\r\n        .then((res) => {\r\n            if (res.username && res.token) {\r\n                setUser({...res}); \r\n            }\r\n            localStorage.setItem('token', user.token);\r\n            setisLogin(true);\r\n        })\r\n        .catch((error) => {\r\n            setError(error);\r\n            setUser(null);\r\n            setisLogin(false);\r\n        })\r\n        .finally(() => setLoading(false));\r\n    }\r\n\r\n    const login = async (username, password) => {\r\n        setLoading(true);\r\n\r\n        let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/login`, {\r\n                \"username\": username,\r\n                \"password\": password\r\n        },{\r\n            headers: {\r\n                'Accept' : 'application/json',\r\n                'Content-Type' : 'application/json',\r\n            }\r\n        })\r\n        .then((res) => {\r\n            if (res.username && res.token) {\r\n                setUser(res); \r\n            }\r\n            console.log(user);\r\n            console.log(\"help\");\r\n            console.log(res);\r\n            localStorage.setItem('token', res.token);\r\n            setisLogin(true);\r\n            history(\"/browse\");\r\n        })\r\n        .catch((error) => {\r\n            let txterr = !error.message ? JSON.stringify(error) : error.message;\r\n            setError(txterr);\r\n            setUser(null);\r\n            setisLogin(false);\r\n        })\r\n        .finally(() => setLoading(false));\r\n    }\r\n\r\n\r\n    const memoedVal = useMemo(() => ({\r\n        user,\r\n        error,\r\n        loading,\r\n        isLogin,\r\n        login,\r\n        signUp\r\n    }),\r\n    [user, loading, error])\r\n\r\n    return (\r\n        <AuthContext.Provider value = {memoedVal}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\nexport default function useAuth() {\r\n    return useContext(AuthContext);\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}