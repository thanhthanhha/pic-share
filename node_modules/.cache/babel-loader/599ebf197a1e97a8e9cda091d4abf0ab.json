{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git\\\\pic\\\\pic-share\\\\src\\\\helpers\\\\useAuth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState();\n  const [error, setError] = useState();\n  const [loading, setLoading] = useState(false);\n  const [isLogin, setisLogin] = useState(false);\n  const location = useLocation();\n  const history = useNavigate();\n  useEffect(() => {\n    if (error) setError(null);\n  }, [location.pathname]);\n  useEffect(() => {// async function verifyLogin() {\n    //     let token = localStorage.getItem('token');\n    //     let res = await axios.get(`${process.env.REACT_APP_BACKEND_URI}/welcome`,{\n    //         headers: {\n    //             'x-access-token' : token,\n    //             'Accept' : 'application/json',\n    //             'Content-Type' : '*/*',\n    //             'User-Agent' : 'Client',\n    //             'Connection' : 'keep-alive',\n    //             'Host' : 'localhost'\n    //         }\n    //     })\n    //     .then(res => {\n    //         if (res.username && res.token) {\n    //             setUser({...res}); \n    //         }\n    //         localStorage.setItem('token', user.token);\n    //         setisLogin(true);\n    //     })\n    //     .catch((error) => {\n    //         setError(error);\n    //         localStorage.removeItem('token');\n    //         setUser(null);\n    //         setisLogin(false);\n    //     })\n    // }\n    // verifyLogin();\n  }, []);\n  useEffect(() => {\n    console.log(\"after hook\");\n    console.log('User', user);\n  }, [user]);\n\n  const signUp = async (email, username, password) => {\n    console.log(\"inside function\");\n    setLoading(true);\n    console.log(process.env.REACT_APP_BACKEND_URI);\n    let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/register`, {\n      \"username\": username,\n      \"email\": email,\n      \"password\": password\n    }, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(res => {\n      console.log(\"res in\");\n      console.log(res);\n\n      if (res.data.username && res.data.token) {\n        console.log({ ...res.data\n        });\n        setUser({ ...res.data\n        }, () => {\n          console.log(user);\n          console.log(\"inside hook\");\n        });\n      } else {\n        throw Promise.reject('token or username not valid check network tab for request payload');\n      }\n\n      console.log(\"work\");\n      console.log(user);\n      localStorage.setItem('token', user.token);\n      setisLogin(true);\n      history(\"/browse\");\n    }).catch(error => {\n      let txterr = !error.message ? JSON.stringify(error) : error.message;\n      setError(txterr);\n      setUser(null);\n      setisLogin(false);\n    }).finally(() => setLoading(false));\n  };\n\n  const login = async (username, password) => {\n    setLoading(true);\n    let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/login`, {\n      \"username\": username,\n      \"password\": password\n    }, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(res => {\n      console.log(\"res in\");\n      console.log(res);\n\n      if (res.data.username && res.data.token) {\n        setUser({ ...res.data\n        });\n        console.log(res);\n      } else {\n        throw Promise.reject('token or username not valid check network tab for request payload');\n      }\n\n      localStorage.setItem('token', user.token);\n      setisLogin(true);\n      history(\"/browse\");\n    }).catch(error => {\n      let txterr = !error.message ? JSON.stringify(error) : error.message;\n      setError(txterr);\n      setUser(null);\n      setisLogin(false);\n    }).finally(() => setLoading(false));\n  };\n\n  const memoedVal = useMemo(() => ({\n    user,\n    error,\n    loading,\n    isLogin,\n    login,\n    signUp\n  }), [user, loading, error]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: memoedVal,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 145,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AuthProvider, \"1sEFrTkgc/VWJpI1XXT1vaoG/EQ=\", false, function () {\n  return [useLocation, useNavigate];\n});\n\n_c = AuthProvider;\nexport default function useAuth() {\n  _s2();\n\n  return useContext(AuthContext);\n}\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","useLocation","useNavigate","axios","AuthContext","AuthProvider","children","user","setUser","error","setError","loading","setLoading","isLogin","setisLogin","location","history","pathname","console","log","signUp","email","username","password","process","env","REACT_APP_BACKEND_URI","res","post","headers","then","data","token","Promise","reject","localStorage","setItem","catch","txterr","message","JSON","stringify","finally","login","memoedVal","useAuth"],"sources":["D:/Git/pic/pic-share/src/helpers/useAuth.js"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport axios from 'axios';\r\n\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n    const [user, setUser] = useState();\r\n    const [error, setError] = useState();\r\n    const [loading, setLoading] = useState(false);\r\n    const [isLogin, setisLogin] = useState(false);\r\n\r\n    const location = useLocation();\r\n    const history = useNavigate();\r\n\r\n    useEffect(() => {\r\n        if (error) setError(null);\r\n      }, [location.pathname]);\r\n\r\n    useEffect(() => {\r\n        // async function verifyLogin() {\r\n        //     let token = localStorage.getItem('token');\r\n        //     let res = await axios.get(`${process.env.REACT_APP_BACKEND_URI}/welcome`,{\r\n        //         headers: {\r\n        //             'x-access-token' : token,\r\n        //             'Accept' : 'application/json',\r\n        //             'Content-Type' : '*/*',\r\n        //             'User-Agent' : 'Client',\r\n        //             'Connection' : 'keep-alive',\r\n        //             'Host' : 'localhost'\r\n        //         }\r\n        //     })\r\n        //     .then(res => {\r\n        //         if (res.username && res.token) {\r\n        //             setUser({...res}); \r\n        //         }\r\n        //         localStorage.setItem('token', user.token);\r\n        //         setisLogin(true);\r\n        //     })\r\n        //     .catch((error) => {\r\n        //         setError(error);\r\n        //         localStorage.removeItem('token');\r\n        //         setUser(null);\r\n        //         setisLogin(false);\r\n        //     })\r\n        // }\r\n\r\n        // verifyLogin();\r\n    },[])\r\n\r\n    useEffect(() => {\r\n        console.log(\"after hook\");\r\n        console.log('User', user);\r\n      }, [user])\r\n\r\n    const signUp = async (email, username, password) => {\r\n        console.log(\"inside function\");\r\n        setLoading(true);\r\n        console.log(process.env.REACT_APP_BACKEND_URI);\r\n\r\n        let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/register`, {\r\n                \"username\": username,\r\n                \"email\" : email,\r\n                \"password\": password\r\n        },{\r\n            headers: {\r\n                'Accept' : 'application/json',\r\n                'Content-Type' : 'application/json',\r\n            }\r\n        })\r\n        .then((res) => {\r\n            console.log(\"res in\");\r\n            console.log(res);\r\n            if (res.data.username && res.data.token) {\r\n                console.log({...res.data});\r\n                setUser({...res.data}, () => {\r\n                    console.log(user);\r\n                    console.log(\"inside hook\");\r\n                }); \r\n            } else {\r\n                throw Promise.reject('token or username not valid check network tab for request payload');\r\n            }\r\n            console.log(\"work\");\r\n            console.log(user);\r\n            localStorage.setItem('token', user.token);\r\n            setisLogin(true);\r\n            history(\"/browse\");\r\n        })\r\n        .catch((error) => {\r\n            let txterr = !error.message ? JSON.stringify(error) : error.message;\r\n            setError(txterr);\r\n            setUser(null);\r\n            setisLogin(false);\r\n        })\r\n        .finally(() => setLoading(false));\r\n    }\r\n\r\n    const login = async (username, password) => {\r\n        setLoading(true);\r\n\r\n        let res = await axios.post(`${process.env.REACT_APP_BACKEND_URI}/login`, {\r\n                \"username\": username,\r\n                \"password\": password\r\n        },{\r\n            headers: {\r\n                'Accept' : 'application/json',\r\n                'Content-Type' : 'application/json',\r\n            }\r\n        })\r\n        .then((res) => {\r\n            console.log(\"res in\");\r\n            console.log(res);\r\n            if (res.data.username && res.data.token) {\r\n                setUser({...res.data});\r\n                console.log(res);\r\n            } else {\r\n                throw Promise.reject('token or username not valid check network tab for request payload');\r\n            }\r\n            localStorage.setItem('token', user.token);\r\n            setisLogin(true);\r\n            history(\"/browse\");\r\n        })\r\n        .catch((error) => {\r\n            let txterr = !error.message ? JSON.stringify(error) : error.message;\r\n            setError(txterr);\r\n            setUser(null);\r\n            setisLogin(false);\r\n        })\r\n        .finally(() => setLoading(false));\r\n    }\r\n\r\n\r\n    const memoedVal = useMemo(() => ({\r\n        user,\r\n        error,\r\n        loading,\r\n        isLogin,\r\n        login,\r\n        signUp\r\n    }),\r\n    [user, loading, error])\r\n\r\n    return (\r\n        <AuthContext.Provider value = {memoedVal}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\nexport default function useAuth() {\r\n    return useContext(AuthContext);\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}